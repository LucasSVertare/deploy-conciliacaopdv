name: Deploy to GKE-teste

steps:
- name: 'gcr.io/cloud-builders/docker'
  args: ['build', '-t', 'gcr.io/cicd-conciliacaopdv/ubuntu:latest', '.']

- name: 'gcr.io/cloud-builders/docker'
  args: ['push', 'gcr.io/cicd-conciliacaopdv/ubuntu:latest']

- name: 'gcr.io/cloud-builders/gcloud'
  args: ['gcloud', 'config', 'set', 'project', 'refined-density-345918']

- name: 'gcr.io/cloud-builders/gcloud'
  args: ['gcloud', 'config', 'set', 'compute/zone', 'southamerica-east1-a']

- name: 'gcr.io/cloud-builders/gcloud'
  args: ['gcloud', 'container', 'clusters', 'get-credentials', 'gke-pnb-homl001']

- name: 'gcr.io/cloud-builders/gcloud'
  args: ['kubectl', 'apply', '-f', 'deployment.yml']

options:
  logging: CLOUD_LOGGING_ONLY
